<div class="row" carrier-controller >
  <div class="col-md-12">
    <h1 ng-if="ctrl.carrier.is_new()">Add a new Carrier</h1>
    <h1 ng-if="!ctrl.carrier.is_new()">Edit Carrier</h1>
  </div>

  <div class="col-md-12"> 
    <form class='form-horizontal smart-form' novalidate ng-submit="ctrl.save()">
      <div class="row">
        <div class="col-md-12">
          <p><span>id</span> #{{ctrl.carrier.id}}</p>
        </div>
      </div>
    <div class="row">
      <div class="col-sm-4 " ng-class="{'has-error':ctrl.carrier.has_errors('name')}">
        <label for="entity_name">Name</label>
        <input type="text" class="form-control" id="entity_name" ng-model='ctrl.carrier.name' placeholder="Name">
        <p ng-show="ctrl.carrier.has_errors('name')" class='error'>{{ctrl.carrier.errors_by_field('name')}}</p>
      </div>
    </div>
    <div class="step1" >
      <div class="locations">
        <div class="row">
          <hr>
        
          <div class="col-md-6">
            <h4 class="not-margin margintitle" >Location</h4>
          </div>
          <div class="col-md-6 text-right">
            <button class='btn btn-primary' type='button' ng-click='ctrl.add_location()'><i class="icon-img-pluss"></i> Add location</button>
          </div>
        </div>
        <div class="location" ng-repeat="location in ctrl.carrier.locations" ng-hide="location.pending_to_delete()">
          <div ng-hide='location.is_expanded()'>
            <div class="row">
              <div class="col-xs-2">
                <p>default</p>
              </div>
              <div class="col-xs-2 form-group" ng-class="{'has-error':location.has_errors('name')}">
                <input ng-model='location.name' class="form-control" placeholder='name'> 
                <p ng-show="location.has_errors('name')" class='error'>{{location.errors_by_field('name')}}</p>       
              </div>
              <div class="col-xs-2 form-group" ng-class="{'has-error':location.has_errors('city')}">
                <input ng-model='location.city' class="form-control" placeholder='city'>
                <p ng-show="location.has_errors('city')" class='error'>{{location.errors_by_field('city')}}</p>
              </div>
              <div class="col-xs-2 form-group" ng-class="{'has-error':location.has_errors('zip')}">
                <input ng-model='location.zip' class="form-control" placeholder='zip'>
                <p ng-show="location.has_errors('zip')" class='error'>{{location.errors_by_field('zip')}}</p>
             </div>
              <div class="col-xs-3 form-group" ng-class="{'has-error':location.has_errors('phone')}">
                <input ng-model='location.phone' class="form-control" placeholder='Phone'>
                <p ng-show="location.has_errors('phone')" class='error'>{{location.errors_by_field('phone')}}</p>
              </div>
              <div class="col-xs-2 actions">
                <button ng-click="location.expand()" type="button" class="btn btn-success"><i class="glyphicon glyphicon-resize-vertical icon-btn"></i></button>
                <button ng-click="ctrl.carrier.delete_location(location)" ng-show='ctrl.carrier.has_many_locations()' type="button" class="btn btn-danger"><i class="glyphicon glyphicon-remove "></i></button>

              </div>
            </div>
          </div>

          <div ng-show="location.is_expanded()">
            <div class="row">
              <div class="col-xs-8" ng-class="{'has-error':location.has_errors('roles')}">
                <div class="col-xs-2">
                  <label >Role</label>
                </div>
                <div class="col-xs-2" ng-repeat="role in ['main','shipper','bill_to','consigner','warehouse']">
                  <label>
                    <input type="checkbox" value="{{role}}" ng-checked="location.roles.indexOf(role) > -1" ng-click="location.toggleRole(role)"> {{role}}
                  </label>
                </div>
                <p ng-show="location.has_errors('roles')" class='error'>{{location.errors_by_field('roles')}}</p>

              </div>
            </div>

            <div class='row'>
              <div class="col-xs-4 " ng-class="{'has-error':location.has_errors('name')}">
                <label for="namelocation">Name</label>
                <input ng-model='location.name' id="namelocation" class="form-control" placeholder='Name'>
                <p ng-show="location.has_errors('name')" class='error'>{{location.errors_by_field('name')}}</p>
              </div>
              <div class="col-xs-2 col-xs-offset-6 actions">
                <button ng-click="location.delete()" ng-show='ctrl.carrier.has_many_locations()' type="button" class="btn pull-right btn-danger"><i class="glyphicon glyphicon-remove "></i></button>
              </div>
            </div>

            <div class="row">
              <div class="col-xs-4" ng-class="{'has-error':location.has_errors('address1')}">
                <label for="streetAdress1">Street Adreess 1</label>
                <input ng-model='location.address1' id="streetAdress1" class="form-control" placeholder='Street Adreess 1'>
                <p ng-show="location.has_errors('address1')" class='error'>{{location.errors_by_field('address1')}}</p>
                
              </div>
              <div class="col-xs-4" ng-class="{'has-error':location.has_errors('address2')}">
                <label for="streetAdress2">Street Adreess 2</label>
                <input ng-model='location.address2' id="streetAdress2" class="form-control" placeholder='Street Adreess 2'>
                <p ng-show="location.has_errors('address2')" class='error'>{{location.errors_by_field('address2')}}</p>
                
              </div>
            </div>

            <div class="row">


              <div class="col-xs-2" ng-class="{'has-error':location.has_errors('countryId')}">
                <label for="countryId">Country</label>
                  <select ng-model="location.countryId" ng-change="ctrl.changeCountries(location)" id="countryId" class="countries form-control" >
                    <option value="" disabled selected>Country</option>
                    <option ng-repeat='country in ctrl.countries' ng-value='country[0]' ng-selected="country[0] == location.countryId">{{country[1]}}</option>
                  </select>
                <p ng-show="location.has_errors('countryId')" class='error'>{{location.errors_by_field('countryId')}}</p>
              </div>
              <div class="col-xs-2" ng-class="{'has-error':location.has_errors('stateId')}">
                <label for="stateId">State</label>
                <select ng-model="location.stateId" id="stateId" class=" states form-control">
                  <option value="" disabled selected>State</option>
                  <option ng-repeat='state in location.states' ng-value='state[0]' ng-selected="state[0] == location.stateId">{{state[1]}}</option>
                </select>
                <p ng-show="location.has_errors('stateId')" class='error'>{{location.errors_by_field('stateId')}}</p>
              </div>
              <div class="col-xs-2" ng-class="{'has-error':location.has_errors('city')}">
                <label for="city">City</label>
                <input ng-model='location.city' id="city" class="form-control" placeholder='City'>
                <p ng-show="location.has_errors('city')" class='error'>{{location.errors_by_field('city')}}</p>
              </div>
              <div class="col-xs-2" ng-class="{'has-error':location.has_errors('zip')}">
                <label for="zip">Zip</label>
                <input ng-model='location.zip' id="zip" class="form-control" placeholder='Zip'>
                <p ng-show="location.has_errors('zip')" class='error'>{{location.errors_by_field('zip')}}</p>
              </div>
            </div>

            <div class='row' style="margin-bottom:0">
              <div class="col-xs-4" ng-class="{'has-error':location.has_errors('phone')}">
                <label for="phone">Phone</label>
                <input ng-model='location.phone' id="phone" class="form-control" placeholder='Phone'>
                <p ng-show="location.has_errors('phone')" class='error'>{{location.errors_by_field('phone')}}</p>
                
              </div>
              <div class="col-xs-4 " ng-class="{'has-error':location.has_errors('email')}">
                <label for="email">Email</label>
                <input ng-model='location.email' id="email" class="form-control" placeholder='Email'>
                <p ng-show="location.has_errors('email')" class='error'>{{location.errors_by_field('email')}}</p>
              </div>
              <div class="col-xs-4 " ng-class="{'has-error':location.has_errors('fax')}">
                <label for="fax">Fax</label>
                <input ng-model='location.fax' class="form-control" placeholder='Fax'>
                <p ng-show="location.has_errors('fax')" class='error'>{{location.errors_by_field('fax')}}</p>
              </div>
            </div>
            
            <div class="row change-inner-content">
              <div class="col-xs-4">
                <label for="freightClass">Freight Class</label>
                <input ng-model='location.freightClass' id="freightClass" class="form-control" placeholder='Freight Class'>
              </div>
              <div class="col-xs-4">
                <label for="naics">NAICS</label>
                <input ng-model='location.naics' id="naics" class="form-control" placeholder='NAICS'>
              </div>
              <div class="col-xs-4">
                <label for="hours">Hours of Operation</label>
                <input ng-model='location.hours' id="hours" class="form-control" placeholder='Hours of Operation           ex 8am - 9pm'>
              </div>
              <div class="col-xs-4">
                <label for="lanecode">Lane Code</label>
                <select ng-model='location.laneCode' id="lanecode" class="form-control">
                  <option value="" disabled selected>Lane Code</option>
                  <option selected >ABC</option>
                </select>
              </div>
              <div class="col-xs-3 marginlabeltop">
                <label class="control-label">Email Opt Out</label>
                <input type='checkbox' value='true' ng-model='location.emailOptOut'>
              </div>
            </div>

    
            <div class="contacts">
              <div class="row">
                <hr/>  
                <div class="col-md-6 ">
                  <h4 class="not-margin">Contact</h4>
                </div>
                <div class="col-md-6 text-right">
                  <button class='btn btn-primary' type='button' ng-click='location.new_empty_contact()'><i class="icon-img-pluss"></i>Add Contact</button>
                </div>
              </div>
              <div class="contact" ng-repeat='contact in location.contacts' >      
                <fieldset class="contact" ng-hide="contact.pending_to_delete()">
                  <div class="row">
                    <div class="col-md-11 col-md-offset-1">
                      <div class="row">
                        <div class="col-md-4" ng-class="{'has-error':contact.has_errors('name')}">
                          <label >Name</label>
                          <input ng-model='contact.name'  class="form-control" placeholder='Name'>
                          <p ng-show="contact.has_errors('name')" class='error'>{{contact.errors_by_field('name')}}</p>
                        </div>
                        <div class="col-md-4" ng-class="{'has-error':contact.has_errors('email')}">
                          <label>Email</label>
                          <input ng-model='contact.email' class="form-control" placeholder='Email'>
                          <p ng-show="contact.has_errors('email')" class='error'>{{contact.errors_by_field('email')}}</p>
                        </div>
                        <div class="col-md-3" ng-class="{'has-error':contact.has_errors('phone')}">
                          <label>Phone</label>
                          <input ng-model='contact.phone' class="form-control" placeholder='Phone'>
                          <p ng-show="contact.has_errors('phone')" class='error'>{{contact.errors_by_field('phone')}}</p>
                        </div>
                        <div class="col-xs-1">
                          <button ng-click='location.delete_contact(contact)' ng-show='location.has_many_contacts()' type="button" class="btn btn-danger"><i class="glyphicon glyphicon-remove "></i></button>
                        </div>
                      </div>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
            <hr>


          </div>
        </div>
      </div>
    </div>
    <hr>
    <div class="data-carrier">
      <div class="row">
        <div class="col-md-2 text-center"> 
          <label for="currency">Currency</label>
          <select ng-model="ctrl.carrier.currency" id="currency" class="form-control">
            <option value="" disabled selected>Currency</option>
            <option value="select">CAD</option>
            <option value="select">USD</option>
          </select>
        </div>

      </div>
      <div class="row">
        <div class="col-md-1">
          <label for="currency">Lanes</label>
        </div>
        <div class="col-md-5">
          <div class="list-group-item row">
            <div id="item-lane" >
              <div id="min-lane" class="col-md-12">
                <button ng-click="lane.expand()" type="button" style="float: right; padding: 11px 16px;" class="btn btn-success"><i class="glyphicon glyphicon-resize-vertical icon-btn"></i></button>
                <div class="list-group">
                  <div class="list-group-item" style="margin-right: 54px;" >
                    <div ng-hide="lane.is_expanded()" style="">
                      <span> {{lane.term1.code}} - {{lane.term2.code}} : {{lane.term1.city}} - {{lane.term2.city}}</span>
                    </div>
                  </div>
                </div>
              </div>
              <div id="detail-lane" class="col-md-12" ng-hide="lane.is_expanded()">
                <div class="form-group" ng-class="{'has-error':lane.has_errors('term1')}">
                  <label for="phone">Terminal 1 (origin)</label>
                  <input ng-model='lane.term1' class="form-control" placeholder='term1'>
                  <p ng-show="lane.has_errors('term1')" class='error'>{{lane.errors_by_field('city')}}</p>
                </div>
                <div class="form-group" ng-class="{'has-error':lane.has_errors('term2')}">
                  <label for="phone">Terminal 2 (destination)</label>
                  <input ng-model='lane.term2' class="form-control" placeholder='term2'>
                  <p ng-show="lane.has_errors('term2')" class='error'>{{lane.errors_by_field('term2')}}</p>
                </div>
                <div class="form-group" ng-class="{'has-error':lane.has_errors('service-note')}">
                  <label for="phone">Service Note</label>
                  <textarea ng-model='lane.service-note' class="form-control" cols="30" rows="5">
                    
                  </textarea>
                  <p ng-show="lane.has_errors('service-note')" class='error'>{{lane.errors_by_field('note')}}</p>
                </div>
              </div>
            </div>
          </div>
          <input type="button" ng-click="ctrl.add_lane()" class='btn btn-primary' value="add lane" />
        </div>
        <div class="col-md-2">
          <input type="button" ng-click="ctrl.stepForm(1)" class='btn btn-primary' value="Prices list" />
        </div>
        <div class="col-md-1">
          <label for="currency">Notes</label>
        </div>
        <div class="col-md-3 text-center">
          <textarea type="email" class="form-control" id="carrier_notes" ng-model="ctrl.carrier.note" placeholder="Notes"></textarea>
        </div>
      </div>
    </div>

    <div>
      <div class="row">
        <div class="col-md-12  text-center">
          <input type="button" ng-click="ctrl.save()" class='btn btn-primary' value="Save and Next" />
          <button class='btn btn-primary'>Save</button>
        </div>
      </div>
    </div>
    </form>
  </div>
</div>